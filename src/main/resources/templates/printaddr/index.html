<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, initial-scale=1.0,minimum-scale=1.0" />
<link rel="stylesheet" type="text/css" href="../css/main.css" th:href="@{/css/printaddr/main.css}" />
<link rel="stylesheet" type="text/css" href="../css/card-tozip.css" th:href="@{/css/printaddr/card-tozip.css}" />
<link rel="stylesheet" type="text/css" href="../css/card-toaddr.css" th:href="@{/css/printaddr/card-toaddr.css}" />
<link rel="stylesheet" type="text/css" href="../css/card-toname.css" th:href="@{/css/printaddr/card-toname.css}" />
<link rel="stylesheet" type="text/css" href="../css/card-fmaddr.css" th:href="@{/css/printaddr/card-fmaddr.css}" />
<link rel="stylesheet" type="text/css" href="../css/card-fmname.css" th:href="@{/css/printaddr/card-fmname.css}" />
<link rel="stylesheet" type="text/css" href="../css/card-fmzip.css" th:href="@{/css/printaddr/card-fmzip.css}" />
<link rel="stylesheet" type="text/css" href="../css/card-namespacing.css" th:href="@{/css/printaddr/card-namespacing.css}"/>
<link rel="stylesheet" type="text/css" href="../css/atrule.css" th:href="@{/css/printaddr/atrule.css}" />
<link rel="stylesheet" type="text/css" href="../css/header.css" th:href="@{/css/printaddr/header.css}" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Kosugi|Kosugi+Maru|M+PLUS+1p|M+PLUS+Rounded+1c|Noto+Sans+JP|Noto+Serif+JP|Sawarabi+Gothic|Sawarabi+Mincho|Material+Icons&display=swap" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-167158475-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-167158475-1');
</script>
<title>年賀状宛名印刷</title>
</head>
<body>

<!--- アプリ領域開始 --->
<style type="text/css">
header h1 {
	font-size: 28px;
	font-family: 'Kosugi Maru';
	margin: 0px;
	padding-left: 60px;
	line-height: 50px;
}
header .hamburger {
	top: 0px;
	left: 0px;
	width: 30px;
	height: 30px;
	padding-top: 5px;
	padding-left: 10px;
	padding-right: 10px;
	padding-bottom: 15px;
	background: #000;
	display: flex;
	justify-content: center;
	align-items: center;
	position: absolute;
}
header .hamburger:hover {
	cursor: pointer;
}
header .hamburger::after {
	position: absolute;
	bottom: 2px;
	content: 'MENU';
	color: #fff;
	font-size: 10px;
}
header .hamburger.active::after {
	content: 'CLOSE';
}
header .hamburger span {
	background: #fff;
	width: 25px;
	height: 2px;
	position: absolute;
	transition: 0.3s ease-out;
}
header .hamburger span:nth-of-type(1) {
	top: 10px;
}
header .hamburger span:nth-of-type(3) {
	bottom: 20px;
}

header .hamburger.active span:nth-of-type(1) {
	transform: translateY(9px) rotate(-45deg);
	transition: 0.3s ease-out;
}
header .hamburger.active span:nth-of-type(3) {
	transform: translateY(-9px) rotate(45deg);
	transition: 0.3s ease-out;
}
header .hamburger.active span:nth-of-type(2) {
	opacity: 0;
}

header .menu {
	width: 96%;
	margin: 1%;
	padding: 1%;
	background: #fff;
	position: absolute;
	transform: translateX(-105%);
	transition: 0.3s ease-out;
	border-radius: 5px;
	box-shadow: 2px 2px 4px gray;
}
header .menu.open {
	transform: translateX(0);
	transition: 0.3s ease-out;
}
.menu .close-menu-btn:hover {
	cursor: pointer;
}

.menu ol {
	margin: 0px;
	padding-left: 25px;
}
.menu li {
	line-height: 40px;
	padding-bottom: 5px;
}

.menu .menu-btn {
	display: inline-block;
	background: #f7f7f7;
	border: solid 2px #FFA000;
	border-radius: 5px;
	box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.7);
	color: #ff7c5c;
	text-decoration: none;
	margin-right: 5px;
}
.menu .menu-btn:hover {
	background: #f7f7f7;
	color: #ff7c5c;
	text-decoration: none;
	cursor: pointer;
}
.menu .menu-btn:active {
	background: #f7f7f7;
	color: #ff7c5c;
	text-decoration: none;
	box-shadow: inset 0 0 2px rgba(128, 128, 128, 0.1);
	transform: translateY(4px);
}

.menu .menu-btn-font {
	font-size: 36px;
	vertical-align: middle;
}

.menu input[type="file"] {
	display: none;
}
.menu .filepath {
	display: inline-block;
	width: 150px;
	vertical-align: middle;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
}

.menu select {
	border: 1px solid #c5c5c5;
	border-radius: 3px;
	font-size: 16px;
	height: 40px;
}

.stamp-sample {
	position: absolute;
	top: 65.0mm;
	left: 35.0mm;
	width: 30.0mm;
	line-height: 10.0mm;
	color: #d94236;
	font-size: 30px;
	font-weight: bold;
	text-align: center;
	border-style: solid;
	border-width: 4px;
//	border-color: red;
	border-color: #d94236;
	border-radius: 5px;
	text-shadow: 1px 1px 2px gray;
	box-shadow: 1px 1px 2px gray;
}

</style>
<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
<script>
$(function(){
	$('.hamburger').click(function(){
		$('.hamburger').toggleClass('active');
		$('.menu').toggleClass('open');
	});
	$('.close-menu').click(function(){
		$('.hamburger').removeClass('active');
		$('.menu').removeClass('open');
	});
});

</script>

<header>
<h1>年賀状宛名印刷</h1>
<a href="#!" class="hamburger">
	<span></span>
	<span></span>
	<span></span>
</a>
<nav class="menu">
<div><span class="material-icons close-menu close-menu-btn">cancel_presentation</span></div>
<ol>
	<li><form name="formdownload">
		<a href="../data/address-template-utf8.csv" th:href="@{/data/printaddr/address-template-utf8.csv}" id="downloadlink" class="menu-btn"><span class="menu-btn-font material-icons">get_app</span></a>
		<select name="selectdownload" id="selectdownload" class="select-wrap">
			<option value="../data/address-template-utf8.csv" th:value="@{/data/printaddr/address-template-utf8.csv}">UTF-8</option>
			<option value="../data/address-template-sjis.csv" th:value="@{/data/printaddr/address-template-sjis.csv}">Shift_JIS</option>
			<option value="../data/address-template.xlsx" th:value="@{/data/printaddr/address-template.xlsx}">Excel</option>
		</select>
		<span>住所録の雛型を取得</span>
		</form></li>
	<li>住所録を<span id="software">Googleスプレッドシート</span>で開く</li>
	<li>住所録の差出人と宛先を編集</li>
	<li>住所録をCSVで保存</li>
	<li><form name="formcsv">
		<input id="csvfile" name="csvfile" type="file" accept=".csv" /><label for="csvfile" class="menu-btn"><span class="menu-btn-font material-icons">folder_open</span></label>
		<select id="selectchar" name="selectchar" class="select-wrap">
			<option value="UTF-8">UTF-8</option>
			<option value="Shift_JIS">Shift_JIS</option>
		</select>
		<label class="filepath" id="filepath">CSVを読み込む</label>
		</form></li>
	<li><form name="formfont">
		<a href="#!" class="menu-btn" onclick="document.formfont.selectfont.focus(); return false;"><span class="menu-btn-font material-icons">text_format</span></a>
		<select name="selectfont" class="select-wrap">
			<option value="" hidden>フォントを選択</option>
			<option value="">(Default Font)</option>
			<option value="'Noto Sans JP', sans-serif">Noto Sans JP</option>
			<option value="'Noto Serif JP', serif">Noto Serif JP</option>
			<option value="'M PLUS 1p', sans-serif">M PLUS 1p</option>
			<option value="'Sawarabi Mincho', sans-serif">Sawarabi Mincho</option>
			<option value="'M PLUS Rounded 1c', sans-serif">M PLUS Rounded 1c</option>
			<option value="'Sawarabi Gothic', sans-serif">Sawarabi Gothic</option>
			<option value="'Kosugi Maru', sans-serif">Kosugi Maru</option>
			<option value="'Kosugi', sans-serif">Kosugi</option>
		</select>
		</form></li>
	<li><a href="#!" class="menu-btn close-menu"><span class="menu-btn-font material-icons">pageview</span></a>できあがりを確認</li>
	<li><a href="#!" class="menu-btn" onclick="window.print(); return false;"><span class="menu-btn-font material-icons">print</span></a>印刷</li>
</ol>
</nav>
</header>
<!--- アプリ領域終了 --->

<article class="close-menu">
	<div id="cards">
	<section class="card">
		<div class="tozip3-1"><p class="t-c">0</p></div>
		<div class="tozip3-2"><p class="t-c">2</p></div>
		<div class="tozip3-3"><p class="t-c">3</p></div>
		<div class="tozip4-1"><p class="t-c">4</p></div>
		<div class="tozip4-2"><p class="t-c">5</p></div>
		<div class="tozip4-3"><p class="t-c">6</p></div>
		<div class="tozip4-4"><p class="t-c">7</p></div>
		<div class="toaddr1"><p class="t-l">神奈川県横浜市保土ヶ谷区西神奈川</p></div>
		<div class="toaddr2"><p class="t-r">四－五六七－八九</p></div>
		<div class="toaddr3"><p class="t-r">グランドマンション一二三号室</p></div>
		<div class="toname1"><p><span class="toname-ls5">佐藤　悠真</span></p></div>
		<div class="totitle1">様</div>
		<div class="toname2"><p><span class="toname-ls6">　　　明日香</span></p></div>
		<div class="totitle2">様</div>
		<div class="toname3"><p><span class="toname-ls4">　　　翼</span></p></div>
		<div class="totitle3">様</div>
		<div class="fmaddr1"><p class="t-l">福岡県北九州市小倉南区北九州海岸</p></div>
		<div class="fmaddr2"><p class="t-r">九－八七六－五四－参弐壱号室</p></div>
		<div class="fmname1"><p><span class="fmname-ls7">鈴木　壱弐参四</span></p></div>
		<div class="fmname2"><p><span class="fmname-ls5">　　　結菜</span></p></div>
		<div class="fmname3"><p><span class="fmname-ls6">　　　一太郎</span></p></div>
		<div class="fmzip3-1"><p class="t-c">9</p></div>
		<div class="fmzip3-2"><p class="t-c">8</p></div>
		<div class="fmzip3-3"><p class="t-c">7</p></div>
		<div class="fmzip4-1"><p class="t-c">6</p></div>
		<div class="fmzip4-2"><p class="t-c">5</p></div>
		<div class="fmzip4-3"><p class="t-c">4</p></div>
		<div class="fmzip4-4"><p class="t-c">3</p></div>
		<div class="stamp-sample">見本</div>
	</section>
	</div>
</article>

<script src="../js/eventlistener.js" th:src="@{/js/printaddr/eventlistener.js}"></script>
<script src="../js/main.js" th:src="@{/js/printaddr/main.js}"></script>
<script src="../js/utility.js" th:src="@{/js/printaddr/utility.js}"></script>
<script>

var formdownload = document.forms.formdownload;
formdownload.selectdownload.addEventListener('change', function(e) {
	changeCsvFile(this);
});

var formcsv = document.forms.formcsv;
formcsv.selectchar.addEventListener('change', function(e) {
	var download = document.getElementById('selectdownload');
	download.options[this.selectedIndex].selected = true;
	changeCsvFile(download);

});

function changeCsvFile(selectdownload) {
	document.getElementById('downloadlink').href = selectdownload.value;

	var soft = document.getElementById('software');
	var char = document.getElementById('selectchar');
	if (selectdownload.selectedIndex === 0) {
		soft.firstChild.nodeValue = 'Googleスプレッドシート';
		char.options[0].selected = true;
	} else {
		soft.firstChild.nodeValue = 'Excel';
		char.options[1].selected = true;
	}
}

</script>

</body>
</html>
